{"ast":null,"code":"var fixRange = require('level-fix-range');\n//get the first/last record in a range\n\nexports = module.exports = peek;\nexports.first = first;\nexports.last = last;\nfunction once(emitter, events, listener) {\n  var remove = [];\n  events.forEach(function (e) {\n    function onEvent(arg) {\n      if (listener(e, arg) === false) return;\n      remove.forEach(function (r) {\n        r();\n      });\n    }\n    emitter.on(e, onEvent);\n    remove.push(function () {\n      emitter.removeListener(e, onEvent);\n    });\n  });\n  return emitter;\n}\nfunction peek(db, opts, cb) {\n  opts.limit = opts.reverse ? 2 : 1;\n  var stream = once(db.createReadStream(opts), ['data', 'error', 'end'], function (event, data) {\n    if (opts.reverse && data && opts.start && data.key.toString() > opts.start) return false;\n    if (event == 'error') cb(data);else if (event == 'end') cb(new Error('range not found'), null, null);else cb(null, data.key, data.value);\n  });\n}\nfunction first(db, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = {};\n  }\n  opts.reverse = false;\n  return peek(db, fixRange(opts), cb);\n}\n\n//SO, this is pretty horrible,\n//but it's works around an issue here\n//https://github.com/rvagg/node-levelup/issues/110\n\nfunction last(db, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = {};\n  }\n  var start = opts.start;\n  opts.reverse = true;\n  return peek(db, fixRange(opts), function (err, key, value) {\n    if (err) {\n      var _start = opts.start;\n      opts.start = null;\n      peek(db, opts, function (_, key, value) {\n        if (!key) return cb(err, null, null);\n        var _key = key.toString();\n        if (_key <= _start && (!opts.end || _key >= opts.end)) cb(_, key, value);else cb(err, null, null);\n      });\n    } else cb(err, key, value);\n  });\n}","map":{"version":3,"names":["fixRange","require","exports","module","peek","first","last","once","emitter","events","listener","remove","forEach","e","onEvent","arg","r","on","push","removeListener","db","opts","cb","limit","reverse","stream","createReadStream","event","data","start","key","toString","Error","value","err","_start","_","_key","end"],"sources":["C:/Users/Moran/Documents/react-projects/react-demo/node_modules/level-peek/index.js"],"sourcesContent":["var fixRange = require('level-fix-range')\n//get the first/last record in a range\n\nexports = module.exports = peek\nexports.first    = first\nexports.last     = last\n\nfunction once(emitter, events, listener) {\n  var remove = []\n  events.forEach(function (e) {\n    function onEvent (arg) {\n      if(listener(e, arg) === false) return\n      remove.forEach(function (r) {\n        r()\n      })\n    }\n    emitter.on(e, onEvent)\n    remove.push(function () {\n      emitter.removeListener(e, onEvent)\n    })\n  })\n  return emitter\n}\n\n\nfunction peek (db, opts, cb) {\n  opts.limit = opts.reverse ? 2 : 1\n  var stream = once(db.createReadStream(opts), \n    ['data', 'error', 'end'],\n    function (event, data) {\n      if(opts.reverse && data && opts.start \n        && (data.key.toString() > opts.start))\n        return false\n      if(event == 'error') cb(data)\n      else if(event == 'end') cb(new Error('range not found'), null, null)\n      else cb(null, data.key, data.value)\n    })\n}\n\nfunction first (db, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = {};\n  }\n  opts.reverse = false\n  return peek(db, fixRange(opts), cb)  \n}\n\n//SO, this is pretty horrible,\n//but it's works around an issue here\n//https://github.com/rvagg/node-levelup/issues/110\n\nfunction last (db, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = {};\n  }\n  var start = opts.start\n  opts.reverse = true\n  return peek(db, fixRange(opts), function (err, key, value) {\n    if(err) {\n      var _start = opts.start\n      opts.start = null\n      peek (db, opts, function (_, key, value) {\n        if(!key) return cb(err, null, null)\n        var _key = key.toString()\n        if(_key <= _start && (!opts.end || _key >= opts.end))\n          cb(_, key, value)\n        else cb(err, null, null)\n      })\n    }\n    else cb(err, key, value)\n  })\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}